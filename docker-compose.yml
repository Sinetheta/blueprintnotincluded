# Production Docker Compose - uses pre-built images
services:
  app:
    image: racefpv/bpni:latest
    container_name: bpni-prod
    environment:
      - ENV_NAME=development
      - BROWSE_INCREMENT=100
      - DB_URI=mongodb://database:27017/blueprintnotincluded
      - JWT_SECRET=anylongstringhere
      - CAPTCHA_SITE=localhost
      - CAPTCHA_SECRET=YOURCAPTCHASECRET
      - MAILJET_API_KEY=produseonly
      - MAILJET_SECRET_KEY=produseonly
      - MAILJET_FROM_EMAIL=help@blueprintnotincluded.org
      - SMTP_HOST=mailhog
      - SMTP_PORT=1025
    depends_on:
      - database
      - mailhog
    ports:
      - "3000:3000"

  database:
    image: mongo:4.2
    container_name: bpni-mongodb
    environment:
      - "MONGO_INITDB_DATABASE=blueprintnotincluded"
    volumes:
      - ./mongo/docker-entrypoint-initdb.d/mongo-init.js:/docker-entrypoint-initdb.d/mongo-init.js:ro
      - mongodb_data:/data/db
    ports:
      - "27017:27017"

  mailhog:
    image: axllent/mailpit
    container_name: bpni-mailhog
    ports:
      - "1025:1025"
      - "8025:8025"

volumes:
  mongodb_data: